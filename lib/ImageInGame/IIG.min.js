var IIG=IIG||{};IIG.ImageManager=function(){this._filenames=[];this._sprites=[];this._spritesInstances=[];this._nbImagesLoaded=0;this._callback=function(){};this.imagesLoaded=false};IIG.ImageManager.prototype={constructor:IIG.ImageManager,add:function(){if(arguments.length===1){this._filenames.push(arguments[0])}else{if(arguments.length>1){for(var a=0,b=arguments.length;a<b;a++){this._filenames.push(arguments[a])}}}},getInstance:function(b){var c=this._sprites[b];var a=new IIG.Image({data:c.data,width:c.width,height:c.height,animation:c.animation});this._spritesInstances.push(a);return a},killInstance:function(b){for(var a=0,e=this._spritesInstances.length;a<e;a++){if(this._spritesInstances[a]===b){this._spritesInstances.splice(a,1)}}if(b instanceof IIG.Image){var d=[b];d.splice(0,1);b=d=undefined}return undefined},loadAll:function(h){if("function"===typeof h){this._callback=h}var e=this;for(var d=0,g=this._filenames.length;d<g;d++){var a=this._filenames[d];var f=new Image();f.src=a;f.onload=function(){e.loaded(this)};var b=/^(.*)\.(png|gif|jpg)$/ig.exec(a)[1];f.setAttribute("data-label",b);this._sprites[b]={data:f,width:0,height:0,animation:null}}},loaded:function(b){var a=b.getAttribute("data-label");this._sprites[a].width=b.width;this._sprites[a].height=b.height;if(++this._nbImagesLoaded===IIG.Utils.count(this._sprites)){this.imagesLoaded=true;this._callback()}},update:function(){for(var a=0,e=this._spritesInstances.length;a<e;a++){if(this._spritesInstances[a] instanceof IIG.Image){var d=this._spritesInstances[a];if(d.animation instanceof IIG.Animation&&!d.animation.pauseAnimation){var b=d.animation;++b.frameCount;if(b.frameCount>=b.animByFrame){b.frameCount=0;if(b.animDirection==="left2right"||b.animDirection==="right2left"){b.sx+=b.sWidth*b.animDirectionMultiplier;if(b.alternate){if(b.sx<=0||b.sx+b.sWidth>=d.width){b.animDirectionMultiplier*=-1}}else{if(b.animDirection==="left2right"){if(b.sx>=d.width){b.sx=0}}else{if(b.animDirection==="right2left"){if(b.sx<0){b.sx=d.width-b.sWidth}}}}}else{if(b.animDirection==="top2bottom"||b.animDirection==="bottom2top"){b.sy+=b.sHeight*b.animDirectionMultiplier;if(b.alternate){if(b.sy<=0||b.sy+b.sHeight>=d.height){b.animDirectionMultiplier*=-1}}else{if(b.animDirection==="top2bottom"){if(b.sy>=d.height){b.sy=0}}else{if(b.animDirection==="bottom2top"){if(b.sy<0){b.sy=d.height-b.sHeight}}}}}}}}}}},drawImage:function(c,b,a,d){if(b.animation instanceof IIG.Animation){return c.drawImage(b.data,b.animation.sx,b.animation.sy,b.animation.sWidth,b.animation.sHeight,a,d,b.animation.sWidth,b.animation.sHeight)}else{return c.drawImage(b.data,a,d)}}};IIG.Animation=function(a){this.frameCount=0;this.sx=0;this.sy=0;this.sWidth=0;this.sHeight=0;this.animDirection="left2right";this.animDirectionMultiplier=1;this.alternate=false;this.animByFrame=12;this.pauseAnimation=false;if("object"===typeof a){this.sx=parseInt(a.sx)>0?a.sx:this.sx;this.sy=parseInt(a.sy)>0?a.sy:this.sy;this.sWidth=parseInt(a.sWidth)>0?a.sWidth:this.sWidth;this.sHeight=parseInt(a.sHeight)>0?a.sHeight:this.sHeight;this.animDirection=(a.animDirection&&(a.animDirection==="right2left"||a.animDirection==="top2bottom"||a.animDirection==="bottom2top"))?a.animDirection:this.animDirection;this.animDirectionMultiplier=(a.animDirection&&(a.animDirection==="right2left"||a.animDirection==="bottom2top"))?-1:1;this.alternate=a.alternate||this.alternate;this.animByFrame=parseInt(a.animByFrame)>0?a.animByFrame:this.animByFrame}};IIG.Image=function(a){if("object"===typeof a){this.data=a.data;this.width=a.width;this.height=a.height;this.animation=a.animation}};IIG.Utils={count:function(c){var b=0,a;for(a in c){if(c.hasOwnProperty(a)){b++}}return b}};